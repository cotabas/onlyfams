var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var e={};(function(t,r){r(e)})(0,(function(e){function createCommonjsModule(t,e){return e={exports:{}},t(e,e.exports),e.exports}var r=createCommonjsModule((function(e,r){(function(t){e.exports=t()})((function(e){var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function md5cycle(t,e){var r=t[0],i=t[1],n=t[2],a=t[3];r+=(i&n|~i&a)+e[0]-680876936|0;r=(r<<7|r>>>25)+i|0;a+=(r&i|~r&n)+e[1]-389564586|0;a=(a<<12|a>>>20)+r|0;n+=(a&r|~a&i)+e[2]+606105819|0;n=(n<<17|n>>>15)+a|0;i+=(n&a|~n&r)+e[3]-1044525330|0;i=(i<<22|i>>>10)+n|0;r+=(i&n|~i&a)+e[4]-176418897|0;r=(r<<7|r>>>25)+i|0;a+=(r&i|~r&n)+e[5]+1200080426|0;a=(a<<12|a>>>20)+r|0;n+=(a&r|~a&i)+e[6]-1473231341|0;n=(n<<17|n>>>15)+a|0;i+=(n&a|~n&r)+e[7]-45705983|0;i=(i<<22|i>>>10)+n|0;r+=(i&n|~i&a)+e[8]+1770035416|0;r=(r<<7|r>>>25)+i|0;a+=(r&i|~r&n)+e[9]-1958414417|0;a=(a<<12|a>>>20)+r|0;n+=(a&r|~a&i)+e[10]-42063|0;n=(n<<17|n>>>15)+a|0;i+=(n&a|~n&r)+e[11]-1990404162|0;i=(i<<22|i>>>10)+n|0;r+=(i&n|~i&a)+e[12]+1804603682|0;r=(r<<7|r>>>25)+i|0;a+=(r&i|~r&n)+e[13]-40341101|0;a=(a<<12|a>>>20)+r|0;n+=(a&r|~a&i)+e[14]-1502002290|0;n=(n<<17|n>>>15)+a|0;i+=(n&a|~n&r)+e[15]+1236535329|0;i=(i<<22|i>>>10)+n|0;r+=(i&a|n&~a)+e[1]-165796510|0;r=(r<<5|r>>>27)+i|0;a+=(r&n|i&~n)+e[6]-1069501632|0;a=(a<<9|a>>>23)+r|0;n+=(a&i|r&~i)+e[11]+643717713|0;n=(n<<14|n>>>18)+a|0;i+=(n&r|a&~r)+e[0]-373897302|0;i=(i<<20|i>>>12)+n|0;r+=(i&a|n&~a)+e[5]-701558691|0;r=(r<<5|r>>>27)+i|0;a+=(r&n|i&~n)+e[10]+38016083|0;a=(a<<9|a>>>23)+r|0;n+=(a&i|r&~i)+e[15]-660478335|0;n=(n<<14|n>>>18)+a|0;i+=(n&r|a&~r)+e[4]-405537848|0;i=(i<<20|i>>>12)+n|0;r+=(i&a|n&~a)+e[9]+568446438|0;r=(r<<5|r>>>27)+i|0;a+=(r&n|i&~n)+e[14]-1019803690|0;a=(a<<9|a>>>23)+r|0;n+=(a&i|r&~i)+e[3]-187363961|0;n=(n<<14|n>>>18)+a|0;i+=(n&r|a&~r)+e[8]+1163531501|0;i=(i<<20|i>>>12)+n|0;r+=(i&a|n&~a)+e[13]-1444681467|0;r=(r<<5|r>>>27)+i|0;a+=(r&n|i&~n)+e[2]-51403784|0;a=(a<<9|a>>>23)+r|0;n+=(a&i|r&~i)+e[7]+1735328473|0;n=(n<<14|n>>>18)+a|0;i+=(n&r|a&~r)+e[12]-1926607734|0;i=(i<<20|i>>>12)+n|0;r+=(i^n^a)+e[5]-378558|0;r=(r<<4|r>>>28)+i|0;a+=(r^i^n)+e[8]-2022574463|0;a=(a<<11|a>>>21)+r|0;n+=(a^r^i)+e[11]+1839030562|0;n=(n<<16|n>>>16)+a|0;i+=(n^a^r)+e[14]-35309556|0;i=(i<<23|i>>>9)+n|0;r+=(i^n^a)+e[1]-1530992060|0;r=(r<<4|r>>>28)+i|0;a+=(r^i^n)+e[4]+1272893353|0;a=(a<<11|a>>>21)+r|0;n+=(a^r^i)+e[7]-155497632|0;n=(n<<16|n>>>16)+a|0;i+=(n^a^r)+e[10]-1094730640|0;i=(i<<23|i>>>9)+n|0;r+=(i^n^a)+e[13]+681279174|0;r=(r<<4|r>>>28)+i|0;a+=(r^i^n)+e[0]-358537222|0;a=(a<<11|a>>>21)+r|0;n+=(a^r^i)+e[3]-722521979|0;n=(n<<16|n>>>16)+a|0;i+=(n^a^r)+e[6]+76029189|0;i=(i<<23|i>>>9)+n|0;r+=(i^n^a)+e[9]-640364487|0;r=(r<<4|r>>>28)+i|0;a+=(r^i^n)+e[12]-421815835|0;a=(a<<11|a>>>21)+r|0;n+=(a^r^i)+e[15]+530742520|0;n=(n<<16|n>>>16)+a|0;i+=(n^a^r)+e[2]-995338651|0;i=(i<<23|i>>>9)+n|0;r+=(n^(i|~a))+e[0]-198630844|0;r=(r<<6|r>>>26)+i|0;a+=(i^(r|~n))+e[7]+1126891415|0;a=(a<<10|a>>>22)+r|0;n+=(r^(a|~i))+e[14]-1416354905|0;n=(n<<15|n>>>17)+a|0;i+=(a^(n|~r))+e[5]-57434055|0;i=(i<<21|i>>>11)+n|0;r+=(n^(i|~a))+e[12]+1700485571|0;r=(r<<6|r>>>26)+i|0;a+=(i^(r|~n))+e[3]-1894986606|0;a=(a<<10|a>>>22)+r|0;n+=(r^(a|~i))+e[10]-1051523|0;n=(n<<15|n>>>17)+a|0;i+=(a^(n|~r))+e[1]-2054922799|0;i=(i<<21|i>>>11)+n|0;r+=(n^(i|~a))+e[8]+1873313359|0;r=(r<<6|r>>>26)+i|0;a+=(i^(r|~n))+e[15]-30611744|0;a=(a<<10|a>>>22)+r|0;n+=(r^(a|~i))+e[6]-1560198380|0;n=(n<<15|n>>>17)+a|0;i+=(a^(n|~r))+e[13]+1309151649|0;i=(i<<21|i>>>11)+n|0;r+=(n^(i|~a))+e[4]-145523070|0;r=(r<<6|r>>>26)+i|0;a+=(i^(r|~n))+e[11]-1120210379|0;a=(a<<10|a>>>22)+r|0;n+=(r^(a|~i))+e[2]+718787259|0;n=(n<<15|n>>>17)+a|0;i+=(a^(n|~r))+e[9]-343485551|0;i=(i<<21|i>>>11)+n|0;t[0]=r+t[0]|0;t[1]=i+t[1]|0;t[2]=n+t[2]|0;t[3]=a+t[3]|0}function md5blk(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}function md5blk_array(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return r}function md51(t){var e,r,i,n,a,s,o=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=o;e+=64)md5cycle(u,md5blk(t.substring(e-64,e)));t=t.substring(e-64);r=t.length;i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);i[e>>2]|=128<<(e%4<<3);if(e>55){md5cycle(u,i);for(e=0;e<16;e+=1)i[e]=0}n=8*o;n=n.toString(16).match(/(.*?)(.{0,8})$/);a=parseInt(n[2],16);s=parseInt(n[1],16)||0;i[14]=a;i[15]=s;md5cycle(u,i);return u}function md51_array(t){var e,r,i,n,a,s,o=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=o;e+=64)md5cycle(u,md5blk_array(t.subarray(e-64,e)));t=e-64<o?t.subarray(e-64):new Uint8Array(0);r=t.length;i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)i[e>>2]|=t[e]<<(e%4<<3);i[e>>2]|=128<<(e%4<<3);if(e>55){md5cycle(u,i);for(e=0;e<16;e+=1)i[e]=0}n=8*o;n=n.toString(16).match(/(.*?)(.{0,8})$/);a=parseInt(n[2],16);s=parseInt(n[1],16)||0;i[14]=a;i[15]=s;md5cycle(u,i);return u}function rhex(t){var e,i="";for(e=0;e<4;e+=1)i+=r[t>>8*e+4&15]+r[t>>8*e&15];return i}function hex(t){var e;for(e=0;e<t.length;e+=1)t[e]=rhex(t[e]);return t.join("")}"5d41402abc4b2a76b9719d911017c592"!==hex(md51("hello"));"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function clamp(t,e){t=0|t||0;return t<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(r,i){var n,a,s,o,u=(this||t).byteLength,l=clamp(r,u),h=u;i!==e&&(h=clamp(i,u));if(l>h)return new ArrayBuffer(0);n=h-l;a=new ArrayBuffer(n);s=new Uint8Array(a);o=new Uint8Array(this||t,l,n);s.set(o);return a}}();function toUtf8(t){/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t)));return t}function utf8Str2ArrayBuffer(t,e){var r,i=t.length,n=new ArrayBuffer(i),a=new Uint8Array(n);for(r=0;r<i;r+=1)a[r]=t.charCodeAt(r);return e?a:n}function arrayBuffer2Utf8Str(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function concatenateArrayBuffers(t,e,r){var i=new Uint8Array(t.byteLength+e.byteLength);i.set(new Uint8Array(t));i.set(new Uint8Array(e),t.byteLength);return r?i:i.buffer}function hexToBinaryString(t){var e,r=[],i=t.length;for(e=0;e<i-1;e+=2)r.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,r)}function SparkMD5(){this.reset()}SparkMD5.prototype.append=function(e){this.appendBinary(toUtf8(e));return this||t};SparkMD5.prototype.appendBinary=function(e){(this||t)._buff+=e;(this||t)._length+=e.length;var r,i=(this||t)._buff.length;for(r=64;r<=i;r+=64)md5cycle((this||t)._hash,md5blk((this||t)._buff.substring(r-64,r)));(this||t)._buff=(this||t)._buff.substring(r-64);return this||t};SparkMD5.prototype.end=function(e){var r,i,n=(this||t)._buff,a=n.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<a;r+=1)s[r>>2]|=n.charCodeAt(r)<<(r%4<<3);this._finish(s,a);i=hex((this||t)._hash);e&&(i=hexToBinaryString(i));this.reset();return i};SparkMD5.prototype.reset=function(){(this||t)._buff="";(this||t)._length=0;(this||t)._hash=[1732584193,-271733879,-1732584194,271733878];return this||t};SparkMD5.prototype.getState=function(){return{buff:(this||t)._buff,length:(this||t)._length,hash:(this||t)._hash}};SparkMD5.prototype.setState=function(e){(this||t)._buff=e.buff;(this||t)._length=e.length;(this||t)._hash=e.hash;return this||t};SparkMD5.prototype.destroy=function(){delete(this||t)._hash;delete(this||t)._buff;delete(this||t)._length};SparkMD5.prototype._finish=function(e,r){var i,n,a,s=r;e[s>>2]|=128<<(s%4<<3);if(s>55){md5cycle((this||t)._hash,e);for(s=0;s<16;s+=1)e[s]=0}i=8*(this||t)._length;i=i.toString(16).match(/(.*?)(.{0,8})$/);n=parseInt(i[2],16);a=parseInt(i[1],16)||0;e[14]=n;e[15]=a;md5cycle((this||t)._hash,e)};SparkMD5.hash=function(t,e){return SparkMD5.hashBinary(toUtf8(t),e)};SparkMD5.hashBinary=function(t,e){var r=md51(t),i=hex(r);return e?hexToBinaryString(i):i};SparkMD5.ArrayBuffer=function(){this.reset()};SparkMD5.ArrayBuffer.prototype.append=function(e){var r,i=concatenateArrayBuffers((this||t)._buff.buffer,e,true),n=i.length;(this||t)._length+=e.byteLength;for(r=64;r<=n;r+=64)md5cycle((this||t)._hash,md5blk_array(i.subarray(r-64,r)));(this||t)._buff=r-64<n?new Uint8Array(i.buffer.slice(r-64)):new Uint8Array(0);return this||t};SparkMD5.ArrayBuffer.prototype.end=function(e){var r,i,n=(this||t)._buff,a=n.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<a;r+=1)s[r>>2]|=n[r]<<(r%4<<3);this._finish(s,a);i=hex((this||t)._hash);e&&(i=hexToBinaryString(i));this.reset();return i};SparkMD5.ArrayBuffer.prototype.reset=function(){(this||t)._buff=new Uint8Array(0);(this||t)._length=0;(this||t)._hash=[1732584193,-271733879,-1732584194,271733878];return this||t};SparkMD5.ArrayBuffer.prototype.getState=function(){var e=SparkMD5.prototype.getState.call(this||t);e.buff=arrayBuffer2Utf8Str(e.buff);return e};SparkMD5.ArrayBuffer.prototype.setState=function(e){e.buff=utf8Str2ArrayBuffer(e.buff,true);return SparkMD5.prototype.setState.call(this||t,e)};SparkMD5.ArrayBuffer.prototype.destroy=SparkMD5.prototype.destroy;SparkMD5.ArrayBuffer.prototype._finish=SparkMD5.prototype._finish;SparkMD5.ArrayBuffer.hash=function(t,e){var r=md51_array(new Uint8Array(t)),i=hex(r);return e?hexToBinaryString(i):i};return SparkMD5}))}));var classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};var i=function(){function defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,i.key,i)}}return function(t,e,r){e&&defineProperties(t.prototype,e);r&&defineProperties(t,r);return t}}();var n=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;var a=function(){i(FileChecksum,null,[{key:"create",value:function create(t,e){var r=new FileChecksum(t);r.create(e)}}]);function FileChecksum(e){classCallCheck(this||t,FileChecksum);(this||t).file=e;(this||t).chunkSize=2097152;(this||t).chunkCount=Math.ceil((this||t).file.size/(this||t).chunkSize);(this||t).chunkIndex=0}i(FileChecksum,[{key:"create",value:function create(e){var i=this||t;(this||t).callback=e;(this||t).md5Buffer=new r.ArrayBuffer;(this||t).fileReader=new FileReader;(this||t).fileReader.addEventListener("load",(function(t){return i.fileReaderDidLoad(t)}));(this||t).fileReader.addEventListener("error",(function(t){return i.fileReaderDidError(t)}));this.readNextChunk()}},{key:"fileReaderDidLoad",value:function fileReaderDidLoad(e){(this||t).md5Buffer.append(e.target.result);if(!this.readNextChunk()){var r=(this||t).md5Buffer.end(true);var i=btoa(r);this.callback(null,i)}}},{key:"fileReaderDidError",value:function fileReaderDidError(e){this.callback("Error reading "+(this||t).file.name)}},{key:"readNextChunk",value:function readNextChunk(){if((this||t).chunkIndex<(this||t).chunkCount||0==(this||t).chunkIndex&&0==(this||t).chunkCount){var e=(this||t).chunkIndex*(this||t).chunkSize;var r=Math.min(e+(this||t).chunkSize,(this||t).file.size);var i=n.call((this||t).file,e,r);(this||t).fileReader.readAsArrayBuffer(i);(this||t).chunkIndex++;return true}return false}}]);return FileChecksum}();function getMetaValue(t){var e=findElement(document.head,'meta[name="'+t+'"]');if(e)return e.getAttribute("content")}function findElements(t,e){if("string"==typeof t){e=t;t=document}var r=t.querySelectorAll(e);return toArray$1(r)}function findElement(t,e){if("string"==typeof t){e=t;t=document}return t.querySelector(e)}function dispatchEvent(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i=t.disabled;var n=r.bubbles,a=r.cancelable,s=r.detail;var o=document.createEvent("Event");o.initEvent(e,n||true,a||true);o.detail=s||{};try{t.disabled=false;t.dispatchEvent(o)}finally{t.disabled=i}return o}function toArray$1(t){return Array.isArray(t)?t:Array.from?Array.from(t):[].slice.call(t)}var s=function(){function BlobRecord(e,r,i){var n=this||t;classCallCheck(this||t,BlobRecord);(this||t).file=e;(this||t).attributes={filename:e.name,content_type:e.type,byte_size:e.size,checksum:r};(this||t).xhr=new XMLHttpRequest;(this||t).xhr.open("POST",i,true);(this||t).xhr.responseType="json";(this||t).xhr.setRequestHeader("Content-Type","application/json");(this||t).xhr.setRequestHeader("Accept","application/json");(this||t).xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");(this||t).xhr.setRequestHeader("X-CSRF-Token",getMetaValue("csrf-token"));(this||t).xhr.addEventListener("load",(function(t){return n.requestDidLoad(t)}));(this||t).xhr.addEventListener("error",(function(t){return n.requestDidError(t)}))}i(BlobRecord,[{key:"create",value:function create(e){(this||t).callback=e;(this||t).xhr.send(JSON.stringify({blob:(this||t).attributes}))}},{key:"requestDidLoad",value:function requestDidLoad(e){if((this||t).status>=200&&(this||t).status<300){var r=(this||t).response;var i=r.direct_upload;delete r.direct_upload;(this||t).attributes=r;(this||t).directUploadData=i;this.callback(null,this.toJSON())}else this.requestDidError(e)}},{key:"requestDidError",value:function requestDidError(e){this.callback('Error creating Blob for "'+(this||t).file.name+'". Status: '+(this||t).status)}},{key:"toJSON",value:function toJSON(){var e={};for(var r in(this||t).attributes)e[r]=(this||t).attributes[r];return e}},{key:"status",get:function get$$1(){return(this||t).xhr.status}},{key:"response",get:function get$$1(){var e=(this||t).xhr,r=e.responseType,i=e.response;return"json"==r?i:JSON.parse(i)}}]);return BlobRecord}();var o=function(){function BlobUpload(e){var r=this||t;classCallCheck(this||t,BlobUpload);(this||t).blob=e;(this||t).file=e.file;var i=e.directUploadData,n=i.url,a=i.headers;(this||t).xhr=new XMLHttpRequest;(this||t).xhr.open("PUT",n,true);(this||t).xhr.responseType="text";for(var s in a)(this||t).xhr.setRequestHeader(s,a[s]);(this||t).xhr.addEventListener("load",(function(t){return r.requestDidLoad(t)}));(this||t).xhr.addEventListener("error",(function(t){return r.requestDidError(t)}))}i(BlobUpload,[{key:"create",value:function create(e){(this||t).callback=e;(this||t).xhr.send((this||t).file.slice())}},{key:"requestDidLoad",value:function requestDidLoad(e){var r=(this||t).xhr,i=r.status,n=r.response;i>=200&&i<300?this.callback(null,n):this.requestDidError(e)}},{key:"requestDidError",value:function requestDidError(e){this.callback('Error storing "'+(this||t).file.name+'". Status: '+(this||t).xhr.status)}}]);return BlobUpload}();var u=0;var l=function(){function DirectUpload(e,r,i){classCallCheck(this||t,DirectUpload);(this||t).id=++u;(this||t).file=e;(this||t).url=r;(this||t).delegate=i}i(DirectUpload,[{key:"create",value:function create(e){var r=this||t;a.create((this||t).file,(function(t,i){if(t)e(t);else{var n=new s(r.file,i,r.url);notify(r.delegate,"directUploadWillCreateBlobWithXHR",n.xhr);n.create((function(t){if(t)e(t);else{var i=new o(n);notify(r.delegate,"directUploadWillStoreFileWithXHR",i.xhr);i.create((function(t){t?e(t):e(null,n.toJSON())}))}}))}}))}}]);return DirectUpload}();function notify(t,e){if(t&&"function"==typeof t[e]){for(var r=arguments.length,i=Array(r>2?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];return t[e].apply(t,i)}}var h=function(){function DirectUploadController(e,r){classCallCheck(this||t,DirectUploadController);(this||t).input=e;(this||t).file=r;(this||t).directUpload=new l((this||t).file,(this||t).url,this||t);this.dispatch("initialize")}i(DirectUploadController,[{key:"start",value:function start(e){var r=this||t;var i=document.createElement("input");i.type="hidden";i.name=(this||t).input.name;(this||t).input.insertAdjacentElement("beforebegin",i);this.dispatch("start");(this||t).directUpload.create((function(t,n){if(t){i.parentNode.removeChild(i);r.dispatchError(t)}else i.value=n.signed_id;r.dispatch("end");e(t)}))}},{key:"uploadRequestDidProgress",value:function uploadRequestDidProgress(t){var e=t.loaded/t.total*100;e&&this.dispatch("progress",{progress:e})}},{key:"dispatch",value:function dispatch(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.file=(this||t).file;r.id=(this||t).directUpload.id;return dispatchEvent((this||t).input,"direct-upload:"+e,{detail:r})}},{key:"dispatchError",value:function dispatchError(t){var e=this.dispatch("error",{error:t});e.defaultPrevented||alert(t)}},{key:"directUploadWillCreateBlobWithXHR",value:function directUploadWillCreateBlobWithXHR(t){this.dispatch("before-blob-request",{xhr:t})}},{key:"directUploadWillStoreFileWithXHR",value:function directUploadWillStoreFileWithXHR(e){var r=this||t;this.dispatch("before-storage-request",{xhr:e});e.upload.addEventListener("progress",(function(t){return r.uploadRequestDidProgress(t)}))}},{key:"url",get:function get$$1(){return(this||t).input.getAttribute("data-direct-upload-url")}}]);return DirectUploadController}();var f="input[type=file][data-direct-upload-url]:not([disabled])";var c=function(){function DirectUploadsController(e){classCallCheck(this||t,DirectUploadsController);(this||t).form=e;(this||t).inputs=findElements(e,f).filter((function(t){return t.files.length}))}i(DirectUploadsController,[{key:"start",value:function start(e){var r=this||t;var i=this.createDirectUploadControllers();var n=function startNextController(){var t=i.shift();if(t)t.start((function(t){if(t){e(t);r.dispatch("end")}else startNextController()}));else{e();r.dispatch("end")}};this.dispatch("start");n()}},{key:"createDirectUploadControllers",value:function createDirectUploadControllers(){var e=[];(this||t).inputs.forEach((function(t){toArray$1(t.files).forEach((function(r){var i=new h(t,r);e.push(i)}))}));return e}},{key:"dispatch",value:function dispatch(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dispatchEvent((this||t).form,"direct-uploads:"+e,{detail:r})}}]);return DirectUploadsController}();var d="data-direct-uploads-processing";var p=new WeakMap;var y=false;function start(){if(!y){y=true;document.addEventListener("click",didClick,true);document.addEventListener("submit",didSubmitForm);document.addEventListener("ajax:before",didSubmitRemoteElement)}}function didClick(t){var e=t.target;"INPUT"!=e.tagName&&"BUTTON"!=e.tagName||"submit"!=e.type||!e.form||p.set(e.form,e)}function didSubmitForm(t){handleFormSubmissionEvent(t)}function didSubmitRemoteElement(t){"FORM"==t.target.tagName&&handleFormSubmissionEvent(t)}function handleFormSubmissionEvent(t){var e=t.target;if(e.hasAttribute(d))t.preventDefault();else{var r=new c(e);var i=r.inputs;if(i.length){t.preventDefault();e.setAttribute(d,"");i.forEach(disable);r.start((function(t){e.removeAttribute(d);t?i.forEach(enable):submitForm(e)}))}}}function submitForm(t){var e=p.get(t)||findElement(t,"input[type=submit], button[type=submit]");if(e){var r=e,i=r.disabled;e.disabled=false;e.focus();e.click();e.disabled=i}else{e=document.createElement("input");e.type="submit";e.style.display="none";t.appendChild(e);e.click();t.removeChild(e)}p.delete(t)}function disable(t){t.disabled=true}function enable(t){t.disabled=false}function autostart(){window.ActiveStorage&&start()}setTimeout(autostart,1);e.start=start;e.DirectUpload=l;Object.defineProperty(e,"__esModule",{value:true})}));const r=e.start,i=e.DirectUpload,n=e.__esModule;export{i as DirectUpload,n as __esModule,e as default,r as start};

//# sourceMappingURL=activestorage.js.map